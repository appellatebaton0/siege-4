[gd_scene load_steps=27 format=3 uid="uid://chm3si0nicqxd"]

[ext_resource type="Script" uid="uid://cvqf1hrebc04p" path="res://scripts/bot.gd" id="1_o5qli"]
[ext_resource type="PackedScene" uid="uid://cef4ydkvvtps0" path="res://scenes/level.tscn" id="1_tbgi4"]
[ext_resource type="Script" uid="uid://dw7w6pry2g435" path="res://scripts/bits/player_animator.gd" id="2_tefeu"]
[ext_resource type="Script" uid="uid://chbr2ps15l74p" path="res://scripts/bits/add.gd" id="4_o6xl0"]
[ext_resource type="Script" uid="uid://b55vjdqvt4nkj" path="res://scripts/values/packed_scene/manual_packedscene.gd" id="4_tipki"]
[ext_resource type="Script" uid="uid://b1o48vkwquyxs" path="res://scripts/values/node/manual_node.gd" id="6_choun"]
[ext_resource type="Script" uid="uid://bslmamakq2ao5" path="res://scripts/values/node/group_node.gd" id="6_tefeu"]
[ext_resource type="Script" uid="uid://b7ecah37jx738" path="res://scripts/bits/player_finished.gd" id="7_o6xl0"]
[ext_resource type="Script" uid="uid://bc87fqj83okns" path="res://scripts/bits/property_modifier.gd" id="8_muem4"]
[ext_resource type="Script" uid="uid://m0fehjfpnp51" path="res://scripts/bits/delete.gd" id="8_tipki"]
[ext_resource type="Script" uid="uid://bxl20cm7r57lo" path="res://scripts/values/string/concat_string.gd" id="9_dp3eg"]
[ext_resource type="Script" uid="uid://bck35smf1mhvk" path="res://scripts/values/float/round.gd" id="10_0ld40"]
[ext_resource type="Script" uid="uid://c7kkv1iuav8gk" path="res://scripts/bits/value.gd" id="13_gqmmt"]
[ext_resource type="Script" uid="uid://hg8o6oww1p4g" path="res://scripts/bits/value_modifier.gd" id="14_yc10j"]
[ext_resource type="Script" uid="uid://cbcstrsy2txwl" path="res://scripts/values/bool/inequality.gd" id="15_0ld40"]
[ext_resource type="Script" uid="uid://b3pqxy3hkl2fo" path="res://scripts/values/float/constrained_float.gd" id="15_jscy8"]
[ext_resource type="Script" uid="uid://dc8sod06feafh" path="res://scripts/values/float/manual_float.gd" id="16_gqmmt"]
[ext_resource type="Script" uid="uid://bdjqjjp8vifaj" path="res://scripts/values/float/cast_float.gd" id="16_pm3ni"]
[ext_resource type="Script" uid="uid://64djo1ycff7k" path="res://scripts/values/bit.gd" id="17_y6deb"]

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_tipki"]
bg_color = Color(0.6, 0.3, 0.15, 1)
border_width_left = 25
border_width_top = 25
border_width_right = 25
border_width_bottom = 25
border_color = Color(0.29803923, 0.1764706, 0.11764706, 1)

[sub_resource type="Theme" id="Theme_85g3d"]
Panel/styles/panel = SubResource("StyleBoxFlat_tipki")

[sub_resource type="Animation" id="Animation_tipki"]
resource_name = "start_to_game"
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("StartScreen:position")
tracks/0/interp = 2
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 1),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Vector2(0, 0), Vector2(1152, 0)]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("InputStopper:visible")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 1),
"transitions": PackedFloat32Array(1, 1),
"update": 1,
"values": [true, false]
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("LostScreen:position")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector2(0, -648)]
}

[sub_resource type="Animation" id="Animation_85g3d"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("StartScreen:position")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector2(0, 0)]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("InputStopper:visible")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [false]
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("LostScreen:position")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector2(0, -648)]
}

[sub_resource type="Animation" id="Animation_choun"]
resource_name = "game_to_lost"
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("LostScreen:position")
tracks/0/interp = 2
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 1),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Vector2(-1152, 0), Vector2(0, 0)]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("StartScreen:position")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector2(1152, 0)]
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("InputStopper:visible")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0, 1),
"transitions": PackedFloat32Array(1, 1),
"update": 1,
"values": [true, false]
}

[sub_resource type="Animation" id="Animation_ya4ey"]
resource_name = "lost_to_game"
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("LostScreen:position")
tracks/0/interp = 2
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 1),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Vector2(0, 0), Vector2(1152, 0)]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("StartScreen:position")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector2(1152, 0)]
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("InputStopper:visible")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0, 1),
"transitions": PackedFloat32Array(1, 1),
"update": 1,
"values": [true, false]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_choun"]
_data = {
&"RESET": SubResource("Animation_85g3d"),
&"game_to_lost": SubResource("Animation_choun"),
&"lost_to_game": SubResource("Animation_ya4ey"),
&"start_to_game": SubResource("Animation_tipki")
}

[node name="Main" type="Node" groups=["Main"]]
script = ExtResource("1_o5qli")

[node name="CanvasLayer" type="CanvasLayer" parent="."]
layer = 2

[node name="Control" type="Control" parent="CanvasLayer"]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
theme = SubResource("Theme_85g3d")

[node name="StartScreen" type="Panel" parent="CanvasLayer/Control"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
offset_right = 0.27539063
grow_horizontal = 2
grow_vertical = 2

[node name="MarginContainer" type="MarginContainer" parent="CanvasLayer/Control/StartScreen"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
theme_override_constants/margin_left = 100
theme_override_constants/margin_top = 100
theme_override_constants/margin_right = 100
theme_override_constants/margin_bottom = 100

[node name="VBoxContainer" type="VBoxContainer" parent="CanvasLayer/Control/StartScreen/MarginContainer"]
layout_mode = 2
theme_override_constants/separation = 74

[node name="Label" type="Label" parent="CanvasLayer/Control/StartScreen/MarginContainer/VBoxContainer"]
layout_mode = 2
size_flags_vertical = 3
theme_override_font_sizes/font_size = 96
text = "MIGRATION"
horizontal_alignment = 1
vertical_alignment = 2

[node name="Button" type="Button" parent="CanvasLayer/Control/StartScreen/MarginContainer/VBoxContainer"]
layout_mode = 2
size_flags_vertical = 3
theme_override_font_sizes/font_size = 41
text = "START"

[node name="Animate" type="Node" parent="CanvasLayer/Control/StartScreen/MarginContainer/VBoxContainer/Button"]
script = ExtResource("2_tefeu")
animation = "start_to_game"
metadata/_custom_type_script = "uid://dw7w6pry2g435"

[node name="ManualNode" type="Node" parent="CanvasLayer/Control/StartScreen/MarginContainer/VBoxContainer/Button/Animate" node_paths=PackedStringArray("response")]
script = ExtResource("6_choun")
response = NodePath("../../../../../../AnimationPlayer")
metadata/_custom_type_script = "uid://b1o48vkwquyxs"

[node name="LoadLevel" type="Node" parent="CanvasLayer/Control/StartScreen/MarginContainer/VBoxContainer/Button"]
script = ExtResource("4_o6xl0")
metadata/_custom_type_script = "uid://chbr2ps15l74p"

[node name="Level" type="Node" parent="CanvasLayer/Control/StartScreen/MarginContainer/VBoxContainer/Button/LoadLevel"]
script = ExtResource("4_tipki")
response = ExtResource("1_tbgi4")
metadata/_custom_type_script = "uid://b55vjdqvt4nkj"

[node name="GroupNode" type="Node" parent="CanvasLayer/Control/StartScreen/MarginContainer/VBoxContainer/Button/LoadLevel"]
script = ExtResource("6_tefeu")
group_name = "Main"
metadata/_custom_type_script = "uid://bslmamakq2ao5"

[node name="LostScreen" type="Panel" parent="CanvasLayer/Control"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
offset_top = -648.0
offset_right = 0.27539063
offset_bottom = -648.0
grow_horizontal = 2
grow_vertical = 2

[node name="MarginContainer" type="MarginContainer" parent="CanvasLayer/Control/LostScreen"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
theme_override_constants/margin_left = 100
theme_override_constants/margin_top = 100
theme_override_constants/margin_right = 100
theme_override_constants/margin_bottom = 100

[node name="VBoxContainer" type="VBoxContainer" parent="CanvasLayer/Control/LostScreen/MarginContainer"]
layout_mode = 2
theme_override_constants/separation = 39

[node name="VBoxContainer" type="VBoxContainer" parent="CanvasLayer/Control/LostScreen/MarginContainer/VBoxContainer"]
layout_mode = 2
size_flags_vertical = 3

[node name="Label" type="Label" parent="CanvasLayer/Control/LostScreen/MarginContainer/VBoxContainer/VBoxContainer"]
layout_mode = 2
size_flags_vertical = 3
theme_override_font_sizes/font_size = 76
text = "You Lost..."
horizontal_alignment = 1
vertical_alignment = 2

[node name="ScoreDisplay" type="Label" parent="CanvasLayer/Control/LostScreen/MarginContainer/VBoxContainer/VBoxContainer"]
layout_mode = 2
size_flags_vertical = 1
theme_override_font_sizes/font_size = 36
text = "Score: 0 | Highscore: 0"
horizontal_alignment = 1
vertical_alignment = 2

[node name="PropertyModifier" type="Node" parent="CanvasLayer/Control/LostScreen/MarginContainer/VBoxContainer/VBoxContainer/ScoreDisplay" node_paths=PackedStringArray("target", "value")]
script = ExtResource("8_muem4")
target = NodePath("ManualNode")
property = "text"
value = NodePath("ScoreText")
constant = true
metadata/_custom_type_script = "uid://bc87fqj83okns"

[node name="ManualNode" type="Node" parent="CanvasLayer/Control/LostScreen/MarginContainer/VBoxContainer/VBoxContainer/ScoreDisplay/PropertyModifier" node_paths=PackedStringArray("response")]
script = ExtResource("6_choun")
response = NodePath("../..")
metadata/_custom_type_script = "uid://b1o48vkwquyxs"

[node name="ScoreText" type="Node" parent="CanvasLayer/Control/LostScreen/MarginContainer/VBoxContainer/VBoxContainer/ScoreDisplay/PropertyModifier" node_paths=PackedStringArray("values")]
script = ExtResource("9_dp3eg")
values = [NodePath("RoundedScore"), NodePath("RoundedHighscore")]
string = "Score: {0} | Highscore: {1}"
metadata/_custom_type_script = "uid://bxl20cm7r57lo"

[node name="RoundedScore" type="Node" parent="CanvasLayer/Control/LostScreen/MarginContainer/VBoxContainer/VBoxContainer/ScoreDisplay/PropertyModifier/ScoreText" node_paths=PackedStringArray("input")]
script = ExtResource("10_0ld40")
input = NodePath("../../../../../../../../../../Highscore/UpdateHS/Higher/Score")
places = 2
metadata/_custom_type_script = "uid://bck35smf1mhvk"

[node name="RoundedHighscore" type="Node" parent="CanvasLayer/Control/LostScreen/MarginContainer/VBoxContainer/VBoxContainer/ScoreDisplay/PropertyModifier/ScoreText" node_paths=PackedStringArray("input")]
script = ExtResource("10_0ld40")
input = NodePath("../../../../../../../../../../Highscore/UpdateHS/Higher/Highscore")
places = 2
metadata/_custom_type_script = "uid://bck35smf1mhvk"

[node name="Button" type="Button" parent="CanvasLayer/Control/LostScreen/MarginContainer/VBoxContainer"]
layout_mode = 2
size_flags_vertical = 3
theme_override_font_sizes/font_size = 41
text = "START"

[node name="Animate" type="Node" parent="CanvasLayer/Control/LostScreen/MarginContainer/VBoxContainer/Button"]
script = ExtResource("2_tefeu")
animation = "lost_to_game"
metadata/_custom_type_script = "uid://dw7w6pry2g435"

[node name="ManualNode" type="Node" parent="CanvasLayer/Control/LostScreen/MarginContainer/VBoxContainer/Button/Animate" node_paths=PackedStringArray("response")]
script = ExtResource("6_choun")
response = NodePath("../../../../../../AnimationPlayer")
metadata/_custom_type_script = "uid://b1o48vkwquyxs"

[node name="LoadLevel" type="Node" parent="CanvasLayer/Control/LostScreen/MarginContainer/VBoxContainer/Button"]
script = ExtResource("4_o6xl0")
metadata/_custom_type_script = "uid://chbr2ps15l74p"

[node name="Level" type="Node" parent="CanvasLayer/Control/LostScreen/MarginContainer/VBoxContainer/Button/LoadLevel"]
script = ExtResource("4_tipki")
response = ExtResource("1_tbgi4")
metadata/_custom_type_script = "uid://b55vjdqvt4nkj"

[node name="GroupNode" type="Node" parent="CanvasLayer/Control/LostScreen/MarginContainer/VBoxContainer/Button/LoadLevel"]
script = ExtResource("6_tefeu")
group_name = "Main"
metadata/_custom_type_script = "uid://bslmamakq2ao5"

[node name="InputStopper" type="Control" parent="CanvasLayer/Control"]
visible = false
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="AnimationPlayer" type="AnimationPlayer" parent="CanvasLayer/Control" groups=["Animator"]]
libraries = {
&"": SubResource("AnimationLibrary_choun")
}

[node name="PlayerFinishedBit" type="Node" parent="CanvasLayer/Control/AnimationPlayer"]
script = ExtResource("7_o6xl0")
animation = "game_to_lost"
metadata/_custom_type_script = "uid://b7ecah37jx738"

[node name="DeleteBit" type="Node" parent="CanvasLayer/Control/AnimationPlayer/PlayerFinishedBit"]
script = ExtResource("8_tipki")
metadata/_custom_type_script = "uid://m0fehjfpnp51"

[node name="GroupNode" type="Node" parent="CanvasLayer/Control/AnimationPlayer/PlayerFinishedBit/DeleteBit"]
script = ExtResource("6_tefeu")
group_name = "Level"
metadata/_custom_type_script = "uid://bslmamakq2ao5"

[node name="Highscore" type="Node" parent="."]
script = ExtResource("13_gqmmt")
id = "highscore"
value = 0.0
metadata/_custom_type_script = "uid://c7kkv1iuav8gk"

[node name="UpdateHS" type="Node" parent="Highscore" node_paths=PackedStringArray("target", "new_value", "condition")]
script = ExtResource("14_yc10j")
target = NodePath("Higher/Highscore/GetHighscore/GetMain")
value_id = "highscore"
new_value = NodePath("Higher")
condition = NodePath("InequalityBool")
metadata/_custom_type_script = "uid://hg8o6oww1p4g"

[node name="InequalityBool" type="Node" parent="Highscore/UpdateHS" node_paths=PackedStringArray("value_a", "value_b")]
script = ExtResource("15_0ld40")
value_a = NodePath("../Higher")
inequality = 3
value_b = NodePath("ManualFloat")
metadata/_custom_type_script = "uid://cbcstrsy2txwl"

[node name="ManualFloat" type="Node" parent="Highscore/UpdateHS/InequalityBool"]
script = ExtResource("16_gqmmt")
metadata/_custom_type_script = "uid://dc8sod06feafh"

[node name="Higher" type="Node" parent="Highscore/UpdateHS" node_paths=PackedStringArray("input", "minimum")]
script = ExtResource("15_jscy8")
input = NodePath("Score")
minimum = NodePath("Highscore")
metadata/_custom_type_script = "uid://b3pqxy3hkl2fo"

[node name="Score" type="Node" parent="Highscore/UpdateHS/Higher"]
script = ExtResource("16_pm3ni")
metadata/_custom_type_script = "uid://bdjqjjp8vifaj"

[node name="GetScore" type="Node" parent="Highscore/UpdateHS/Higher/Score"]
script = ExtResource("17_y6deb")
id = "score"
metadata/_custom_type_script = "uid://64djo1ycff7k"

[node name="GetLevel" type="Node" parent="Highscore/UpdateHS/Higher/Score/GetScore"]
script = ExtResource("6_tefeu")
group_name = "Level"
metadata/_custom_type_script = "uid://bslmamakq2ao5"

[node name="Highscore" type="Node" parent="Highscore/UpdateHS/Higher"]
script = ExtResource("16_pm3ni")
metadata/_custom_type_script = "uid://bdjqjjp8vifaj"

[node name="GetHighscore" type="Node" parent="Highscore/UpdateHS/Higher/Highscore"]
script = ExtResource("17_y6deb")
id = "highscore"
metadata/_custom_type_script = "uid://64djo1ycff7k"

[node name="GetMain" type="Node" parent="Highscore/UpdateHS/Higher/Highscore/GetHighscore" node_paths=PackedStringArray("response")]
script = ExtResource("6_choun")
response = NodePath("../../../../../..")
metadata/_custom_type_script = "uid://b1o48vkwquyxs"

[connection signal="pressed" from="CanvasLayer/Control/StartScreen/MarginContainer/VBoxContainer/Button" to="CanvasLayer/Control/StartScreen/MarginContainer/VBoxContainer/Button/Animate" method="animate"]
[connection signal="pressed" from="CanvasLayer/Control/StartScreen/MarginContainer/VBoxContainer/Button" to="CanvasLayer/Control/StartScreen/MarginContainer/VBoxContainer/Button/LoadLevel" method="add"]
[connection signal="pressed" from="CanvasLayer/Control/LostScreen/MarginContainer/VBoxContainer/Button" to="CanvasLayer/Control/LostScreen/MarginContainer/VBoxContainer/Button/Animate" method="animate"]
[connection signal="pressed" from="CanvasLayer/Control/LostScreen/MarginContainer/VBoxContainer/Button" to="CanvasLayer/Control/LostScreen/MarginContainer/VBoxContainer/Button/LoadLevel" method="add"]
[connection signal="finished" from="CanvasLayer/Control/AnimationPlayer/PlayerFinishedBit" to="CanvasLayer/Control/AnimationPlayer/PlayerFinishedBit/DeleteBit" method="delete"]
